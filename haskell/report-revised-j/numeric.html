<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP">
  <title>The Haskell 98 Library Report: Numerics</title>
 </head>

 <body bgcolor="#ffffff">
  <p><i>The Haskell 98 Report</i><br />
   <a href="index.html">top</a> | <a href="complex.html">back</a> | <a
   href="ix.html">next</a> | <a href="index98.html">contents</a> | <a
   href="prelude-index.html">function index</a> <br />
  </p>
  <hr />

  <p><a name="lib-numeric"></a><a name="sect14"></a></p>
  <!--<h2>14<tt>&nbsp;&nbsp;</tt>Numeric</h2>-->
  <h2>14<tt>&nbsp;&nbsp;</tt>数値</h2>
  <p>
  <table border="2" cellpadding="3">
   <tr>
    <td> <tt><br />
     module&nbsp;Numeric(fromRat,<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showSigned,&nbsp;showIntAtBase,<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showInt,&nbsp;showOct,&nbsp;showHex,<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readSigned,&nbsp;readInt,<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readDec,&nbsp;readOct,&nbsp;readHex,&nbsp;<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatToDigits,<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showEFloat,&nbsp;showFFloat,&nbsp;showGFloat,&nbsp;showFloat,&nbsp;<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readFloat,&nbsp;lexDigits)&nbsp;where<br />
     <br />
     fromRat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;a<br />
     <br />
     showSigned&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;(a&nbsp;-&gt;&nbsp;ShowS)&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showIntAtBase&nbsp;&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Int&nbsp;-&gt;&nbsp;Char)&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showInt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showOct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showHex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     <br />
     readSigned&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a&nbsp;-&gt;&nbsp;ReadS&nbsp;a<br />
     readInt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;<br />
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;-&gt;&nbsp;(Char&nbsp;-&gt;&nbsp;Bool)&nbsp;-&gt;&nbsp;(Char&nbsp;-&gt;&nbsp;Int)&nbsp;-&gt;&nbsp;ReadS&nbsp;a<br />
     readDec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
     readOct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
     readHex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
     <br />
     showEFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showFFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showGFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     showFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
     <br />
     floatToDigits&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Integer&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;([Int],&nbsp;Int)<br />
     <br />
     readFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFrac&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
     lexDigits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;ReadS&nbsp;String&nbsp;<br />
     </tt></td>
   </tr>
  </table>
  </p>
  <!--
  <p>This library contains assorted numeric functions, many of which are
   used in the standard Prelude.</p>
  -->
  <p>
   このライブラリには各種の関数が含まれいる。その多くが
   標準プレリュードで使用されている。
  </p>
  <!--
  <p> In what follows, recall the following type definitions from the
   <tt>Prelude</tt>: <tt><br />
   &nbsp;<br />
   &nbsp;&nbsp;type&nbsp;ShowS&nbsp;=&nbsp;String&nbsp;-&gt;&nbsp;String<br />
   &nbsp;&nbsp;type&nbsp;ReadS&nbsp;=&nbsp;String&nbsp;-&gt;&nbsp;[(a,String)]<br />
   <br />
   </tt></p>
  -->
  <p>
   このあとでは、<tt>Prelude</tt> で定義されている以下の型定義を思い出す
   こと。
   <tt><br />
   &nbsp;<br />
   &nbsp;&nbsp;type&nbsp;ShowS&nbsp;=&nbsp;String&nbsp;-&gt;&nbsp;String<br />
   &nbsp;&nbsp;type&nbsp;ReadS&nbsp;=&nbsp;String&nbsp;-&gt;&nbsp;[(a,String)]<br />
   <br />
   </tt>
  </p>

  <p> <a name="sect14.1"></a></p>
  <!--<h3>14.1<tt>&nbsp;&nbsp;</tt>Showing functions</h3>-->
  <h3>14.1<tt>&nbsp;&nbsp;</tt>表示関数</h3>
  <!--
  <p>
  <ul>
   <li><tt>showSigned&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;(a&nbsp;-&gt;&nbsp;ShowS)&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
    <br />
    converts a possibly-negative <tt>Real</tt> value of type <tt>a</tt> to
    a string. In the call <i>(</i><tt>showSigned</tt><i> show prec
    val)</i>, <i>val</i> is the value to show, <i>prec</i> is the
    precedence of the enclosing context, and <i>show</i> is a function that
    can show unsigned values.
    <p></p>
   </li>
   <li><tt>showIntAtBase&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Int&nbsp;-&gt;&nbsp;Char)&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
    <br />
    shows a <i>non-negative</i> <tt>Integral</tt> number using the base
    specified by the first argument, and the character representation
    specified by the second.
    <p></p>
   </li>
   <li><tt>showInt,&nbsp;showOct,&nbsp;showHex&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
    <br />
    show <i>non-negative</i> <tt>Integral</tt> numbers in base 10, 8, and
    16 respectively.
    <p></p>
   </li>
   <li> <tt>showFFloat,&nbsp;showEFloat,&nbsp;showGFloat</tt> <br />
    <tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
    <br />
    These three functions all show signed <tt>RealFloat</tt> values:
    <ul>
     <li><tt>showFFloat</tt> uses standard decimal notation (e.g.
      <tt>245000</tt>, <tt>0.0015</tt>).</li>
     <li><tt>showEFloat</tt> uses scientific (exponential) notation (e.g.
      <tt>2.45e2</tt>, <tt>1.5e-3</tt>).</li>
     <li><tt>showGFloat</tt> uses standard decimal notation for arguments
      whose absolute value lies between <tt>0.1</tt> and
      <tt>9,999,999</tt>, and scientific notation otherwise.</li>
    </ul>
    In the call <i>(</i><tt>showEFloat</tt><i> digs val)</i>, if
    <i>digs</i> is <tt>Nothing</tt>, the value is shown to full precision;
    if <i>digs</i> is <tt>Just</tt><i> d</i>, then at most <i>d</i> digits
    after the decimal point are shown. Exactly the same applies to the
    <i>digs</i> argument of the other two functions.
    <p></p>
   </li>
   <li><tt>floatToDigits&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Integer&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;([Int],&nbsp;Int)</tt>
    <br />
    converts a base and a value to the representation of the value in
    digits, plus an exponent. More specifically, if <tt>floatToDigits</tt>
    b r = <tt>([</tt>d_1, d_2, ... d_n<tt>],&nbsp;</tt>e<tt>) </tt>then the
    following properties hold:
    <ul>
     <li>r = 0.d<sub>1</sub> d<sub>2</sub> ..., d<sub>n</sub> *
      b<sup>e</sup></li>

     <li>n &gt;=0</li>

     <li>d<sub>1</sub> /=0 (when n &gt; 0)</li>

     <li>0 &lt;=d<sub>i</sub> &lt;=b-1</li>
    </ul>
   </li>
  </ul>
  </p>
  -->
  <p>
   <ul>
    <li>
     <p>
      <tt>showSigned&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;(a&nbsp;-&gt;&nbsp;ShowS)&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
      <br />
      は、負の可能性のある型 <tt>a</tt> の <tt>Real</tt> 値を文字列に
      変換する。<i>(</i><tt>showSigned</tt><i> show prec val)</i> の呼び
      出しにおいて、<i>val</i> は表示される値であり、<i>prec</i> はそれ
      を囲む文脈の優先度で、<i>show</i> は符号が付かない値を表示できる
      関数である。
     </p>
    </li>
    <li>
     <p>
      <tt>showIntAtBase&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Int&nbsp;-&gt;&nbsp;Char)&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
      <br />
      は<em>非負の</em> <tt>Integral</tt> クラスの数値を第1引数で指定さ
      れた基数で表示する．第2引数で表示するための文字を指定する．
    </p>
   </li>
   <li><tt>showInt,&nbsp;showOct,&nbsp;showHex&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
    <br />
      は、<em>非負の</em> <tt>Integral</tt> クラスの数値をそれぞれ、10 進、
      8 進、16 進で表示する。</p>
    </li>
    <li>
     <p>
      <tt>showFFloat,&nbsp;showEFloat,&nbsp;showGFloat</tt> <br />
      <tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS</tt>
      <br />
      これらの 3 つの関数はすべて、符号付 <tt>RealFloat</tt> クラスの
      値を表示する。</p>
     <p>
      <ul>
       <li><tt>showFFloat</tt> は標準の小数表記(たとえば、
        <tt>245000</tt>, <tt>0.0015</tt>) に使用する。</li>
       <li><tt>showEFloat</tt> は科学表記(指数表記) (たとえば、
        <tt>2.45e2</tt>, <tt>1.5e-3</tt>) に使用する。</li>
       <li><tt>showGFloat</tt> は、絶対値が <tt>0.1</tt> と
        <tt>9,999,999</tt> の間にある場合には標準の小数表記、
        それ以外の場合には科学表記に使用する。</li>
      </ul>
     </p>
     <p>
      <i>(</i><tt>showEFloat</tt><i> digs val)</i> の呼び出しにおいて、
      <i>digs</i> が <tt>Nothing</tt> なら、その値は丸めなしで表示され、
      <i>digs</i> が <tt>Just</tt> <i>d</i> ならば、小数点以下は
      多くても <i>d</i> 桁で表示される。<i>digs</i> 引数は他の 2 つの
      関数ででも同様に適用される。
     </p>
    </li>
    <li>
     <p>
      <tt>floatToDigits&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Integer&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;([Int],&nbsp;Int)</tt>
      <br />
      は基数と値とを、各桁のリストと指数で表現する。<tt>floatToDigits</tt>
      b r = <tt>([</tt>d_1, d_2, ... d_n<tt>],&nbsp;</tt>e<tt>) </tt> 
      ならば、以下の性質が維持される。
     </p>
     <p>
      <ul>
       <li>
        r = 0.d<sub>1</sub> d<sub>2</sub> ..., d<sub>n</sub> *
        b<sup>e</sup>
       </li>
       <li>n &gt;=0</li>
       <li>d<sub>1</sub> /=0 (when n &gt; 0)</li>
       <li>0 &lt;=d<sub>i</sub> &lt;=b-1</li>
      </ul>
     </p>
    </li>
   </ul>
  </p>
  <p> <a name="sect14.2"></a></p>
  <!--<h3>14.2<tt>&nbsp;&nbsp;</tt>Reading functions</h3>-->
  <h3>14.2<tt>&nbsp;&nbsp;</tt>読み込み関数</h3>
  <!--
  <p>
  <ul>
   <li><tt>readSigned&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a&nbsp;-&gt;&nbsp;ReadS&nbsp;a</tt>
    <br />
    reads a <i>signed</i> <tt>Real</tt> value, given a reader for an
    unsigned value.
    <p></p>
   </li>

   <li><tt>readInt&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Char-&gt;Bool)&nbsp;-&gt;&nbsp;(Char-&gt;Int)&nbsp;-&gt;&nbsp;ReadS&nbsp;a</tt>
    <br />
    reads an <i>unsigned</i> <tt>Integral</tt> value in an arbitrary base.
    In the call <i>(</i><tt>readInt</tt><i> base isdig d2i)</i>,
    <i>base</i> is the base, <i>isdig</i> is a predicate distinguishing
    valid digits in this base, and <i>d2i</i> converts a valid digit
    character to an <tt>Int</tt>.
    <p></p>
   </li>

   <li><tt>readFloat&nbsp;::&nbsp;(RealFrac&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a</tt>
    <br />
    reads an <i>unsigned</i> <tt>RealFrac</tt> value, expressed in decimal
    scientific notation.
    <p></p>
   </li>

   <li><tt>readDec,&nbsp;readOct,&nbsp;readHex&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a</tt>
    <br />
    each read an unsigned number, in decimal, octal, and hexadecimal
    notation respectively. In the hexadecimal case, both upper or lower
    case letters are allowed.
    <p></p>
   </li>

   <li><tt>lexDigits&nbsp;::&nbsp;ReadS&nbsp;String</tt> reads a non-empty
    string of decimal digits.</li>
  </ul>
  </p>
  -->
  <p>
  <ul>
   <li>
    <p>
     <tt>readSigned&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a&nbsp;-&gt;&nbsp;ReadS&nbsp;a</tt>
     <br />
     は、符号の付かない値用の読み込み関数を与えられると、
     <em>符号付き</em>の <tt>Real</tt> クラスの値を読み込む。
    </p>
   </li>
   <li>
    <p>
     <tt>readInt&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Char-&gt;Bool)&nbsp;-&gt;&nbsp;(Char-&gt;Int)&nbsp;-&gt;&nbsp;ReadS&nbsp;a</tt>
     <br />
     は、<em>符号の付かない</em> <tt>Integral</tt> クラスの値を任意の
     基数で読み込む。<i>(</i><tt>readInt</tt><i> base isdig d2i)</i> の
     呼び出しにおいて、<i>base</i> は基数であり、<i>isdig</i> はその
     基数として正当な数字であるかどうかを判定する述語である。また、
     <i>d2i</i> は正当な数字を <tt>Int</tt> へ変換する。
    </p>
   </li>
   <li>
    <p>
     <tt>readFloat&nbsp;::&nbsp;(RealFrac&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a</tt>
     <br />
     は、科学記法で表現された<em>符号の付かない</em> <tt>RealFrac</tt> 
     クラスの値を読み込む。
    </p>
   </li>
   <li>
    <p>
     <tt>readDec,&nbsp;readOct,&nbsp;readHex&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a</tt>
     <br />
     は、それぞれ、10 進、8 進、16 進記法の符号の付かない数値を読み込む。
     16 進の場合には、大文字、小文字のどちらでもよい。
    </p>
   </li>
   <li>
    <p>
     <tt>lexDigits&nbsp;::&nbsp;ReadS&nbsp;String</tt><br />
     は 10 進数の空ではない文字列を読み込む。
    </p>
   </li>
  </ul>
  </p>
  <!--
  <p>(NB: <tt>readInt</tt> is the "dual" of <tt>showIntAtBase</tt>, and
   <tt>readDec</tt> is the "dual" of <tt>showInt</tt>. The inconsistent
   naming is a historical accident.)</p>
  -->
  <p>
   (注意：<tt>readInt</tt> は <tt>showIntAtBase</tt> と「双対」をなし、
   <tt>readDec</tt> は <tt>showInt</tt> と「双対」をなす。名前の不整合は
   歴史的理由による。)
  </p>

  <p> <a name="sect14.3"></a></p>
  <!--<h3>14.3<tt>&nbsp;&nbsp;</tt>Miscellaneous</h3>-->
  <h3>14.3<tt>&nbsp;&nbsp;</tt>その他</h3>
  <!--
  <p>
  <ul>
   <li><tt>fromRat&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;a</tt>
    converts a <tt>Rational</tt> value into any type in class
    <tt>RealFloat</tt>.</li>
  </ul>
  </p>
  -->
  <p>
  <ul>
   <li>
    <tt>fromRat&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;a</tt><br />
    は、<tt>Rational</tt> クラスの値を、任意の <tt>RealFlat</tt> の
    クラスの値に変換する。
   </li>
  </ul>
  </p>

  <p> <a name="sect14.4"></a></p>
  <!--<h3>14.4<tt>&nbsp;&nbsp;</tt>Library <tt>Numeric</tt></h3>-->
  <h3>14.4<tt>&nbsp;&nbsp;</tt><tt>Numeric</tt> ライブラリ</h3>

  <p><tt><br />
   module&nbsp;Numeric(fromRat,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showSigned,&nbsp;showIntAtBase,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showInt,&nbsp;showOct,&nbsp;showHex,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readSigned,&nbsp;readInt,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readDec,&nbsp;readOct,&nbsp;readHex,&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatToDigits,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showEFloat,&nbsp;showFFloat,&nbsp;showGFloat,&nbsp;showFloat,&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readFloat,&nbsp;lexDigits)&nbsp;where<br />
   <br />
   import&nbsp;Char&nbsp;&nbsp;&nbsp;(&nbsp;isDigit,&nbsp;isOctDigit,&nbsp;isHexDigit<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;digitToInt,&nbsp;intToDigit&nbsp;)<br />
   import&nbsp;Ratio&nbsp;&nbsp;(&nbsp;(%),&nbsp;numerator,&nbsp;denominator&nbsp;)<br />
   import&nbsp;Array&nbsp;&nbsp;(&nbsp;(!),&nbsp;Array,&nbsp;array&nbsp;)<br />
   <br />
   --&nbsp;This&nbsp;converts&nbsp;a&nbsp;rational&nbsp;to&nbsp;a&nbsp;floating.&nbsp;&nbsp;This&nbsp;should&nbsp;be&nbsp;used&nbsp;in&nbsp;the<br />
   --&nbsp;Fractional&nbsp;instances&nbsp;of&nbsp;Float&nbsp;and&nbsp;Double.<br />
   <br />
   fromRat&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;a<br />
   fromRat&nbsp;x&nbsp;=&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;==&nbsp;0&nbsp;then&nbsp;encodeFloat&nbsp;0&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Handle&nbsp;exceptional&nbsp;cases<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;-&nbsp;fromRat'&nbsp;(-x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;first.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;fromRat'&nbsp;x<br />
   <br />
   --&nbsp;Conversion&nbsp;process:<br />
   --&nbsp;Scale&nbsp;the&nbsp;rational&nbsp;number&nbsp;by&nbsp;the&nbsp;RealFloat&nbsp;base&nbsp;until<br />
   --&nbsp;it&nbsp;lies&nbsp;in&nbsp;the&nbsp;range&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;(as&nbsp;used&nbsp;by&nbsp;decodeFloat/encodeFloat).<br />
   --&nbsp;Then&nbsp;round&nbsp;the&nbsp;rational&nbsp;to&nbsp;an&nbsp;Integer&nbsp;and&nbsp;encode&nbsp;it&nbsp;with&nbsp;the&nbsp;exponent<br />
   --&nbsp;that&nbsp;we&nbsp;got&nbsp;from&nbsp;the&nbsp;scaling.<br />
   --&nbsp;To&nbsp;speed&nbsp;up&nbsp;the&nbsp;scaling&nbsp;process&nbsp;we&nbsp;compute&nbsp;the&nbsp;log2&nbsp;of&nbsp;the&nbsp;number&nbsp;to&nbsp;get<br />
   --&nbsp;a&nbsp;first&nbsp;guess&nbsp;of&nbsp;the&nbsp;exponent.<br />
   fromRat'&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;a<br />
   fromRat'&nbsp;x&nbsp;=&nbsp;r<br />
   &nbsp;&nbsp;where&nbsp;b&nbsp;=&nbsp;floatRadix&nbsp;r<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;floatDigits&nbsp;r<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(minExp0,&nbsp;_)&nbsp;=&nbsp;floatRange&nbsp;r<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minExp&nbsp;=&nbsp;minExp0&nbsp;-&nbsp;p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;the&nbsp;real&nbsp;minimum&nbsp;exponent<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xMin&nbsp;=&nbsp;toRational&nbsp;(expt&nbsp;b&nbsp;(p-1))<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xMax&nbsp;=&nbsp;toRational&nbsp;(expt&nbsp;b&nbsp;p)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p0&nbsp;=&nbsp;(integerLogBase&nbsp;b&nbsp;(numerator&nbsp;x)&nbsp;-<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integerLogBase&nbsp;b&nbsp;(denominator&nbsp;x)&nbsp;-&nbsp;p)&nbsp;`max`&nbsp;minExp<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;if&nbsp;p0&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;1&nbsp;%&nbsp;expt&nbsp;b&nbsp;(-p0)&nbsp;else&nbsp;expt&nbsp;b&nbsp;p0&nbsp;%&nbsp;1<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x',&nbsp;p')&nbsp;=&nbsp;scaleRat&nbsp;(toRational&nbsp;b)&nbsp;minExp&nbsp;xMin&nbsp;xMax&nbsp;p0&nbsp;(x&nbsp;/&nbsp;f)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;encodeFloat&nbsp;(round&nbsp;x')&nbsp;p'<br />
   <br />
   --&nbsp;Scale&nbsp;x&nbsp;until&nbsp;xMin&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;xMax,&nbsp;or&nbsp;p&nbsp;(the&nbsp;exponent)&nbsp;&lt;=&nbsp;minExp.<br />
   scaleRat&nbsp;::&nbsp;Rational&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Int&nbsp;-&gt;&nbsp;Rational&nbsp;-&gt;&nbsp;(Rational,&nbsp;Int)<br />
   scaleRat&nbsp;b&nbsp;minExp&nbsp;xMin&nbsp;xMax&nbsp;p&nbsp;x&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;&lt;=&nbsp;minExp&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x,&nbsp;p)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;x&nbsp;&gt;=&nbsp;xMax&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scaleRat&nbsp;b&nbsp;minExp&nbsp;xMin&nbsp;xMax&nbsp;(p+1)&nbsp;(x/b)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;xMin&nbsp;&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scaleRat&nbsp;b&nbsp;minExp&nbsp;xMin&nbsp;xMax&nbsp;(p-1)&nbsp;(x*b)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x,&nbsp;p)<br />
   <br />
   --&nbsp;Exponentiation&nbsp;with&nbsp;a&nbsp;cache&nbsp;for&nbsp;the&nbsp;most&nbsp;common&nbsp;numbers.<br />
   minExpt&nbsp;=&nbsp;0::Int<br />
   maxExpt&nbsp;=&nbsp;1100::Int<br />
   expt&nbsp;::&nbsp;Integer&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;Integer<br />
   expt&nbsp;base&nbsp;n&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;base&nbsp;==&nbsp;2&nbsp;&amp;&amp;&nbsp;n&nbsp;&gt;=&nbsp;minExpt&nbsp;&amp;&amp;&nbsp;n&nbsp;&lt;=&nbsp;maxExpt&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expts!n<br />
   &nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base^n<br />
   <br />
   expts&nbsp;::&nbsp;Array&nbsp;Int&nbsp;Integer<br />
   expts&nbsp;=&nbsp;array&nbsp;(minExpt,maxExpt)&nbsp;[(n,2^n)&nbsp;|&nbsp;n&nbsp;&lt;-&nbsp;[minExpt&nbsp;..&nbsp;maxExpt]]<br />
   <br />
   --&nbsp;Compute&nbsp;the&nbsp;(floor&nbsp;of&nbsp;the)&nbsp;log&nbsp;of&nbsp;i&nbsp;in&nbsp;base&nbsp;b.<br />
   --&nbsp;Simplest&nbsp;way&nbsp;would&nbsp;be&nbsp;just&nbsp;divide&nbsp;i&nbsp;by&nbsp;b&nbsp;until&nbsp;it's&nbsp;smaller&nbsp;then&nbsp;b,<br />
   --&nbsp;but&nbsp;that&nbsp;would&nbsp;be&nbsp;very&nbsp;slow!&nbsp;&nbsp;We&nbsp;are&nbsp;just&nbsp;slightly&nbsp;more&nbsp;clever.<br />
   integerLogBase&nbsp;::&nbsp;Integer&nbsp;-&gt;&nbsp;Integer&nbsp;-&gt;&nbsp;Int<br />
   integerLogBase&nbsp;b&nbsp;i&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;b&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Try&nbsp;squaring&nbsp;the&nbsp;base&nbsp;first&nbsp;to&nbsp;cut&nbsp;down&nbsp;the&nbsp;number&nbsp;of&nbsp;divisions.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;l&nbsp;=&nbsp;2&nbsp;*&nbsp;integerLogBase&nbsp;(b*b)&nbsp;i<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doDiv&nbsp;::&nbsp;Integer&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;Int<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doDiv&nbsp;i&nbsp;l&nbsp;=&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;b&nbsp;then&nbsp;l&nbsp;else&nbsp;doDiv&nbsp;(i&nbsp;`div`&nbsp;b)&nbsp;(l+1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;doDiv&nbsp;(i&nbsp;`div`&nbsp;(b^l))&nbsp;l<br />
   <br />
   <br />
   --&nbsp;Misc&nbsp;utilities&nbsp;to&nbsp;show&nbsp;integers&nbsp;and&nbsp;floats&nbsp;<br />
   <br />
   showSigned&nbsp;::&nbsp;Real&nbsp;a&nbsp;=&gt;&nbsp;(a&nbsp;-&gt;&nbsp;ShowS)&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   showSigned&nbsp;showPos&nbsp;p&nbsp;x&nbsp;<br />
   &nbsp;&nbsp;|&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;showParen&nbsp;(p&nbsp;&gt;&nbsp;6)&nbsp;(showChar&nbsp;'-'&nbsp;.&nbsp;showPos&nbsp;(-x))<br />
   &nbsp;&nbsp;|&nbsp;otherwise&nbsp;=&nbsp;showPos&nbsp;x<br />
   <br />
   --&nbsp;showInt,&nbsp;showOct,&nbsp;showHex&nbsp;are&nbsp;used&nbsp;for&nbsp;positive&nbsp;numbers&nbsp;only<br />
   showInt,&nbsp;showOct,&nbsp;showHex&nbsp;::&nbsp;Integral&nbsp;a&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   showOct&nbsp;=&nbsp;showIntAtBase&nbsp;&nbsp;8&nbsp;intToDigit<br />
   showInt&nbsp;=&nbsp;showIntAtBase&nbsp;10&nbsp;intToDigit<br />
   showHex&nbsp;=&nbsp;showIntAtBase&nbsp;16&nbsp;intToDigit<br />
   <br />
   showIntAtBase&nbsp;::&nbsp;Integral&nbsp;a&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;base<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;(Int&nbsp;-&gt;&nbsp;Char)&nbsp;&nbsp;--&nbsp;digit&nbsp;to&nbsp;char<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;number&nbsp;to&nbsp;show<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;ShowS<br />
   showIntAtBase&nbsp;base&nbsp;intToDig&nbsp;n&nbsp;rest<br />
   &nbsp;&nbsp;|&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;error&nbsp;"Numeric.showIntAtBase:&nbsp;can't&nbsp;show&nbsp;negative&nbsp;numbers"<br />
   &nbsp;&nbsp;|&nbsp;n'&nbsp;==&nbsp;0&nbsp;&nbsp;&nbsp;=&nbsp;rest'<br />
   &nbsp;&nbsp;|&nbsp;otherwise&nbsp;=&nbsp;showIntAtBase&nbsp;base&nbsp;intToDig&nbsp;n'&nbsp;rest'<br />
   &nbsp;&nbsp;where<br />
   &nbsp;&nbsp;&nbsp;&nbsp;(n',d)&nbsp;=&nbsp;quotRem&nbsp;n&nbsp;base<br />
   &nbsp;&nbsp;&nbsp;&nbsp;rest'&nbsp;&nbsp;=&nbsp;intToDig&nbsp;(fromIntegral&nbsp;d)&nbsp;:&nbsp;rest<br />
   <br />
   <br />
   readSigned&nbsp;::&nbsp;(Real&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a&nbsp;-&gt;&nbsp;ReadS&nbsp;a<br />
   readSigned&nbsp;readPos&nbsp;=&nbsp;readParen&nbsp;False&nbsp;read'<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;read'&nbsp;r&nbsp;&nbsp;=&nbsp;read''&nbsp;r&nbsp;++<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(-x,t)&nbsp;|&nbsp;("-",s)&nbsp;&lt;-&nbsp;lex&nbsp;r,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(x,t)&nbsp;&nbsp;&nbsp;&lt;-&nbsp;read''&nbsp;s]<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read''&nbsp;r&nbsp;=&nbsp;[(n,s)&nbsp;&nbsp;|&nbsp;(str,s)&nbsp;&lt;-&nbsp;lex&nbsp;r,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(n,"")&nbsp;&nbsp;&lt;-&nbsp;readPos&nbsp;str]<br />
   <br />
   <br />
   --&nbsp;readInt&nbsp;reads&nbsp;a&nbsp;string&nbsp;of&nbsp;digits&nbsp;using&nbsp;an&nbsp;arbitrary&nbsp;base.&nbsp;&nbsp;<br />
   --&nbsp;Leading&nbsp;minus&nbsp;signs&nbsp;must&nbsp;be&nbsp;handled&nbsp;elsewhere.<br />
   <br />
   readInt&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;(Char&nbsp;-&gt;&nbsp;Bool)&nbsp;-&gt;&nbsp;(Char&nbsp;-&gt;&nbsp;Int)&nbsp;-&gt;&nbsp;ReadS&nbsp;a<br />
   readInt&nbsp;radix&nbsp;isDig&nbsp;digToInt&nbsp;s&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;[(foldl1&nbsp;(\n&nbsp;d&nbsp;-&gt;&nbsp;n&nbsp;*&nbsp;radix&nbsp;+&nbsp;d)&nbsp;(map&nbsp;(fromIntegral&nbsp;.&nbsp;digToInt)&nbsp;ds),&nbsp;r)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(ds,r)&nbsp;&lt;-&nbsp;nonnull&nbsp;isDig&nbsp;s&nbsp;]<br />
   <br />
   --&nbsp;Unsigned&nbsp;readers&nbsp;for&nbsp;various&nbsp;bases<br />
   readDec,&nbsp;readOct,&nbsp;readHex&nbsp;::&nbsp;(Integral&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
   readDec&nbsp;=&nbsp;readInt&nbsp;10&nbsp;isDigit&nbsp;&nbsp;&nbsp;&nbsp;digitToInt<br />
   readOct&nbsp;=&nbsp;readInt&nbsp;&nbsp;8&nbsp;isOctDigit&nbsp;digitToInt<br />
   readHex&nbsp;=&nbsp;readInt&nbsp;16&nbsp;isHexDigit&nbsp;digitToInt<br />
   <br />
   <br />
   showEFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   showFFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   showGFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   showFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;a&nbsp;-&gt;&nbsp;ShowS<br />
   <br />
   showEFloat&nbsp;d&nbsp;x&nbsp;=&nbsp;&nbsp;showString&nbsp;(formatRealFloat&nbsp;FFExponent&nbsp;d&nbsp;x)<br />
   showFFloat&nbsp;d&nbsp;x&nbsp;=&nbsp;&nbsp;showString&nbsp;(formatRealFloat&nbsp;FFFixed&nbsp;d&nbsp;x)<br />
   showGFloat&nbsp;d&nbsp;x&nbsp;=&nbsp;&nbsp;showString&nbsp;(formatRealFloat&nbsp;FFGeneric&nbsp;d&nbsp;x)<br />
   showFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;showGFloat&nbsp;Nothing&nbsp;<br />
   <br />
   --&nbsp;These&nbsp;are&nbsp;the&nbsp;format&nbsp;types.&nbsp;&nbsp;This&nbsp;type&nbsp;is&nbsp;not&nbsp;exported.<br />
   <br />
   data&nbsp;FFFormat&nbsp;=&nbsp;FFExponent&nbsp;|&nbsp;FFFixed&nbsp;|&nbsp;FFGeneric<br />
   <br />
   formatRealFloat&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;FFFormat&nbsp;-&gt;&nbsp;Maybe&nbsp;Int&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;String<br />
   formatRealFloat&nbsp;fmt&nbsp;decs&nbsp;x&nbsp;<br />
   &nbsp;&nbsp;=&nbsp;s<br />
   &nbsp;&nbsp;where&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;=&nbsp;10<br />
   &nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;if&nbsp;isNaN&nbsp;x&nbsp;then&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"NaN"<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;isInfinite&nbsp;x&nbsp;then&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;"-Infinity"&nbsp;else&nbsp;"Infinity"<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;isNegativeZero&nbsp;x&nbsp;then&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'-'&nbsp;:&nbsp;doFmt&nbsp;fmt&nbsp;(floatToDigits&nbsp;(toInteger&nbsp;base)&nbsp;(-x))<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doFmt&nbsp;fmt&nbsp;(floatToDigits&nbsp;(toInteger&nbsp;base)&nbsp;x)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;doFmt&nbsp;fmt&nbsp;(is,&nbsp;e)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;let&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;=&nbsp;map&nbsp;intToDigit&nbsp;is<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;fmt&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FFGeneric&nbsp;-&gt;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doFmt&nbsp;(if&nbsp;e&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;e&nbsp;&gt;&nbsp;7&nbsp;then&nbsp;FFExponent&nbsp;else&nbsp;FFFixed)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(is,&nbsp;e)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FFExponent&nbsp;-&gt;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;decs&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;-&gt;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;ds&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;"0.0e0"<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[d]&nbsp;&nbsp;&nbsp;-&gt;&nbsp;d&nbsp;:&nbsp;".0e"&nbsp;++&nbsp;show&nbsp;(e-1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:ds&nbsp;&nbsp;-&gt;&nbsp;d&nbsp;:&nbsp;'.'&nbsp;:&nbsp;ds&nbsp;++&nbsp;'e':show&nbsp;(e-1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Just&nbsp;dec&nbsp;-&gt;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dec'&nbsp;=&nbsp;max&nbsp;dec&nbsp;1&nbsp;in<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;is&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;-&gt;&nbsp;'0':'.':take&nbsp;dec'&nbsp;(repeat&nbsp;'0')&nbsp;++&nbsp;"e0"<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;-&gt;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(ei,&nbsp;is')&nbsp;=&nbsp;roundTo&nbsp;base&nbsp;(dec'+1)&nbsp;is<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:ds&nbsp;=&nbsp;map&nbsp;intToDigit<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;ei&nbsp;&gt;&nbsp;0&nbsp;then&nbsp;init&nbsp;is'&nbsp;else&nbsp;is')<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;d:'.':ds&nbsp;&nbsp;++&nbsp;"e"&nbsp;++&nbsp;show&nbsp;(e-1+ei)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FFFixed&nbsp;-&gt;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;decs&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nothing&nbsp;
   --&nbsp;Always&nbsp;prints&nbsp;a&nbsp;decimal&nbsp;point<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;e&nbsp;&gt;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;take&nbsp;e&nbsp;(ds&nbsp;++&nbsp;repeat&nbsp;'0')<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++&nbsp;'.'&nbsp;:&nbsp;mk0&nbsp;(drop&nbsp;e&nbsp;ds)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;otherwise&nbsp;-&gt;&nbsp;"0."&nbsp;++&nbsp;mk0&nbsp;(replicate&nbsp;(-e)&nbsp;'0'&nbsp;++&nbsp;ds)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Just&nbsp;dec&nbsp;-&gt;&nbsp;&nbsp;--&nbsp;Print&nbsp;decimal&nbsp;point&nbsp;iff&nbsp;dec&nbsp;&gt;&nbsp;0<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;dec'&nbsp;=&nbsp;max&nbsp;dec&nbsp;0&nbsp;in<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;&gt;=&nbsp;0&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(ei,&nbsp;is')&nbsp;=&nbsp;roundTo&nbsp;base&nbsp;(dec'&nbsp;+&nbsp;e)&nbsp;is<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ls,&nbsp;rs)&nbsp;&nbsp;=&nbsp;splitAt&nbsp;(e+ei)&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(map&nbsp;intToDigit&nbsp;is')<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;mk0&nbsp;ls&nbsp;++&nbsp;mkdot0&nbsp;rs<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(ei,&nbsp;is')&nbsp;=&nbsp;roundTo&nbsp;base&nbsp;dec'&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(replicate&nbsp;(-e)&nbsp;0&nbsp;++&nbsp;is)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:&nbsp;ds&nbsp;=&nbsp;map&nbsp;intToDigit&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;ei&nbsp;&gt;&nbsp;0&nbsp;then&nbsp;is'&nbsp;else&nbsp;0:is')<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;d&nbsp;:&nbsp;mkdot0&nbsp;ds<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mk0&nbsp;""&nbsp;=&nbsp;"0"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Print&nbsp;0.34,&nbsp;not&nbsp;.34<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mk0&nbsp;s&nbsp;&nbsp;=&nbsp;s&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdot0&nbsp;""&nbsp;=&nbsp;""&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Print&nbsp;34,&nbsp;not&nbsp;34.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdot0&nbsp;s&nbsp;&nbsp;=&nbsp;'.'&nbsp;:&nbsp;s&nbsp;&nbsp;--&nbsp;when&nbsp;the&nbsp;format&nbsp;specifies&nbsp;no<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;digits&nbsp;after&nbsp;the&nbsp;decimal&nbsp;point<br />
   &nbsp;&nbsp;&nbsp;&nbsp;<br />
   <br />
   roundTo&nbsp;::&nbsp;Int&nbsp;-&gt;&nbsp;Int&nbsp;-&gt;&nbsp;[Int]&nbsp;-&gt;&nbsp;(Int,&nbsp;[Int])<br />
   roundTo&nbsp;base&nbsp;d&nbsp;is&nbsp;=&nbsp;case&nbsp;f&nbsp;d&nbsp;is&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0,&nbsp;is)&nbsp;-&gt;&nbsp;(0,&nbsp;is)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1,&nbsp;is)&nbsp;-&gt;&nbsp;(1,&nbsp;1&nbsp;:&nbsp;is)<br />
   &nbsp;&nbsp;where&nbsp;b2&nbsp;=&nbsp;base&nbsp;`div`&nbsp;2<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;n&nbsp;[]&nbsp;=&nbsp;(0,&nbsp;replicate&nbsp;n&nbsp;0)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;0&nbsp;(i:_)&nbsp;=&nbsp;(if&nbsp;i&nbsp;&gt;=&nbsp;b2&nbsp;then&nbsp;1&nbsp;else&nbsp;0,&nbsp;[])<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;d&nbsp;(i:is)&nbsp;=&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(c,&nbsp;ds)&nbsp;=&nbsp;f&nbsp;(d-1)&nbsp;is<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i'&nbsp;=&nbsp;c&nbsp;+&nbsp;i<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;if&nbsp;i'&nbsp;==&nbsp;base&nbsp;then&nbsp;(1,&nbsp;0:ds)&nbsp;else&nbsp;(0,&nbsp;i':ds)<br />
   <br />
   --<br />
   --&nbsp;Based&nbsp;on&nbsp;"Printing&nbsp;Floating-Point&nbsp;Numbers&nbsp;Quickly&nbsp;and&nbsp;Accurately"<br />
   --&nbsp;by&nbsp;R.G.&nbsp;Burger&nbsp;and&nbsp;R.&nbsp;K.&nbsp;Dybvig,&nbsp;in&nbsp;PLDI&nbsp;96.<br />
   --&nbsp;The&nbsp;version&nbsp;here&nbsp;uses&nbsp;a&nbsp;much&nbsp;slower&nbsp;logarithm&nbsp;estimator.&nbsp;&nbsp;<br />
   --&nbsp;It&nbsp;should&nbsp;be&nbsp;improved.<br />
   <br />
   --&nbsp;This&nbsp;function&nbsp;returns&nbsp;a&nbsp;non-empty&nbsp;list&nbsp;of&nbsp;digits&nbsp;(Ints&nbsp;in&nbsp;[0..base-1])<br />
   --&nbsp;and&nbsp;an&nbsp;exponent.&nbsp;&nbsp;In&nbsp;general,&nbsp;if<br />
   --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;floatToDigits&nbsp;r&nbsp;=&nbsp;([a,&nbsp;b,&nbsp;...&nbsp;z],&nbsp;e)<br />
   --&nbsp;then<br />
   --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;0.ab..z&nbsp;*&nbsp;base^e<br />
   --&nbsp;<br />
   <br />
   floatToDigits&nbsp;::&nbsp;(RealFloat&nbsp;a)&nbsp;=&gt;&nbsp;Integer&nbsp;-&gt;&nbsp;a&nbsp;-&gt;&nbsp;([Int],&nbsp;Int)<br />
   <br />
   floatToDigits&nbsp;_&nbsp;0&nbsp;=&nbsp;([],&nbsp;0)<br />
   floatToDigits&nbsp;base&nbsp;x&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(f0,&nbsp;e0)&nbsp;=&nbsp;decodeFloat&nbsp;x<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(minExp0,&nbsp;_)&nbsp;=&nbsp;floatRange&nbsp;x<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;floatDigits&nbsp;x<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;floatRadix&nbsp;x<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minExp&nbsp;=&nbsp;minExp0&nbsp;-&nbsp;p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;the&nbsp;real&nbsp;minimum&nbsp;exponent<br />
   <br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Haskell&nbsp;requires&nbsp;that&nbsp;f&nbsp;be&nbsp;adjusted&nbsp;so&nbsp;denormalized&nbsp;numbers<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;will&nbsp;have&nbsp;an&nbsp;impossibly&nbsp;low&nbsp;exponent.&nbsp;&nbsp;Adjust&nbsp;for&nbsp;this.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;::&nbsp;Integer<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;::&nbsp;Int<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f,&nbsp;e)&nbsp;=&nbsp;let&nbsp;n&nbsp;=&nbsp;minExp&nbsp;-&nbsp;e0<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;if&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;then&nbsp;(f0&nbsp;`div`&nbsp;(b^n),&nbsp;e0+n)&nbsp;else&nbsp;(f0,&nbsp;e0)<br />
   <br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(r,&nbsp;s,&nbsp;mUp,&nbsp;mDn)&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;&gt;=&nbsp;0&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;be&nbsp;=&nbsp;b^e&nbsp;in<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;f&nbsp;==&nbsp;b^(p-1)&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f*be*b*2,&nbsp;2*b,&nbsp;be*b,&nbsp;b)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f*be*2,&nbsp;2,&nbsp;be,&nbsp;be)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;&gt;&nbsp;minExp&nbsp;&amp;&amp;&nbsp;f&nbsp;==&nbsp;b^(p-1)&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f*b*2,&nbsp;b^(-e+1)*2,&nbsp;b,&nbsp;1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(f*2,&nbsp;b^(-e)*2,&nbsp;1,&nbsp;1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;k0&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;b==2&nbsp;&amp;&amp;&nbsp;base==10&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;logBase&nbsp;10&nbsp;2&nbsp;is&nbsp;slightly&nbsp;bigger&nbsp;than&nbsp;3/10&nbsp;so<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;the&nbsp;following&nbsp;will&nbsp;err&nbsp;on&nbsp;the&nbsp;low&nbsp;side.&nbsp;&nbsp;Ignoring<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;the&nbsp;fraction&nbsp;will&nbsp;make&nbsp;it&nbsp;err&nbsp;even&nbsp;more.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Haskell&nbsp;promises&nbsp;that&nbsp;p-1&nbsp;&lt;=&nbsp;logBase&nbsp;b&nbsp;f&nbsp;&lt;&nbsp;p.<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(p&nbsp;-&nbsp;1&nbsp;+&nbsp;e0)&nbsp;*&nbsp;3&nbsp;`div`&nbsp;10<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ceiling&nbsp;((log&nbsp;(fromInteger&nbsp;(f+1))&nbsp;+&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fromIntegral&nbsp;e&nbsp;*&nbsp;log&nbsp;(fromInteger&nbsp;b))&nbsp;/&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log&nbsp;(fromInteger&nbsp;base))<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixup&nbsp;n&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;r&nbsp;+&nbsp;mUp&nbsp;&lt;=&nbsp;expt&nbsp;base&nbsp;n&nbsp;*&nbsp;s&nbsp;then&nbsp;n&nbsp;else&nbsp;fixup&nbsp;(n+1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;expt&nbsp;base&nbsp;(-n)&nbsp;*&nbsp;(r&nbsp;+&nbsp;mUp)&nbsp;&lt;=&nbsp;s&nbsp;then&nbsp;n<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;fixup&nbsp;(n+1)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;fixup&nbsp;k0<br />
   <br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;ds&nbsp;rn&nbsp;sN&nbsp;mUpN&nbsp;mDnN&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;(dn,&nbsp;rn')&nbsp;=&nbsp;(rn&nbsp;*&nbsp;base)&nbsp;`divMod`&nbsp;sN<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mUpN'&nbsp;=&nbsp;mUpN&nbsp;*&nbsp;base<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mDnN'&nbsp;=&nbsp;mDnN&nbsp;*&nbsp;base<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;case&nbsp;(rn'&nbsp;&lt;&nbsp;mDnN',&nbsp;rn'&nbsp;+&nbsp;mUpN'&nbsp;&gt;&nbsp;sN)&nbsp;of<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(True,&nbsp;&nbsp;False)&nbsp;-&gt;&nbsp;dn&nbsp;:&nbsp;ds<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(False,&nbsp;True)&nbsp;&nbsp;-&gt;&nbsp;dn+1&nbsp;:&nbsp;ds<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(True,&nbsp;&nbsp;True)&nbsp;&nbsp;-&gt;&nbsp;if&nbsp;rn'&nbsp;*&nbsp;2&nbsp;&lt;&nbsp;sN&nbsp;then&nbsp;dn&nbsp;:&nbsp;ds&nbsp;else&nbsp;dn+1&nbsp;:&nbsp;ds<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(False,&nbsp;False)&nbsp;-&gt;&nbsp;gen&nbsp;(dn:ds)&nbsp;rn'&nbsp;sN&nbsp;mUpN'&nbsp;mDnN'<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rds&nbsp;=<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;&gt;=&nbsp;0&nbsp;then<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;[]&nbsp;r&nbsp;(s&nbsp;*&nbsp;expt&nbsp;base&nbsp;k)&nbsp;mUp&nbsp;mDn<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;bk&nbsp;=&nbsp;expt&nbsp;base&nbsp;(-k)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;gen&nbsp;[]&nbsp;(r&nbsp;*&nbsp;bk)&nbsp;s&nbsp;(mUp&nbsp;*&nbsp;bk)&nbsp;(mDn&nbsp;*&nbsp;bk)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;&nbsp;(map&nbsp;fromIntegral&nbsp;(reverse&nbsp;rds),&nbsp;k)<br />
   <br />
   <br />
   <br />
   --&nbsp;This&nbsp;floating&nbsp;point&nbsp;reader&nbsp;uses&nbsp;a&nbsp;less&nbsp;restrictive&nbsp;syntax&nbsp;for&nbsp;floating<br />
   --&nbsp;point&nbsp;than&nbsp;the&nbsp;Haskell&nbsp;lexer.&nbsp;&nbsp;The&nbsp;`.'&nbsp;is&nbsp;optional.<br />
   <br />
   readFloat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(RealFrac&nbsp;a)&nbsp;=&gt;&nbsp;ReadS&nbsp;a<br />
   readFloat&nbsp;r&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;[(fromRational&nbsp;((n%1)*10^^(k-d)),t)&nbsp;|&nbsp;(n,d,s)&nbsp;&lt;-&nbsp;readFix&nbsp;r,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(k,t)&nbsp;&nbsp;&nbsp;&lt;-&nbsp;readExp&nbsp;s]&nbsp;++<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;(0/0,&nbsp;t)&nbsp;|&nbsp;("NaN",t)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&nbsp;lex&nbsp;r]&nbsp;++<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;(1/0,&nbsp;t)&nbsp;|&nbsp;("Infinity",t)&nbsp;&lt;-&nbsp;lex&nbsp;r]<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readFix&nbsp;r&nbsp;=&nbsp;[(read&nbsp;(ds++ds'),&nbsp;length&nbsp;ds',&nbsp;t)<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(ds,d)&nbsp;&lt;-&nbsp;lexDigits&nbsp;r,<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ds',t)&nbsp;&lt;-&nbsp;lexFrac&nbsp;d&nbsp;]<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lexFrac&nbsp;('.':ds)&nbsp;=&nbsp;lexDigits&nbsp;ds<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lexFrac&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;[("",s)]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readExp&nbsp;(e:s)&nbsp;|&nbsp;e&nbsp;`elem`&nbsp;"eE"&nbsp;=&nbsp;readExp'&nbsp;s<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readExp&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;[(0,s)]<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readExp'&nbsp;('-':s)&nbsp;=&nbsp;[(-k,t)&nbsp;|&nbsp;(k,t)&nbsp;&lt;-&nbsp;readDec&nbsp;s]<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readExp'&nbsp;('+':s)&nbsp;=&nbsp;readDec&nbsp;s<br />
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readExp'&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;readDec&nbsp;s<br />
   <br />
   lexDigits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;ReadS&nbsp;String&nbsp;<br />
   lexDigits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;nonnull&nbsp;isDigit<br />
   <br />
   nonnull&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;(Char&nbsp;-&gt;&nbsp;Bool)&nbsp;-&gt;&nbsp;ReadS&nbsp;String<br />
   nonnull&nbsp;p&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;[(cs,t)&nbsp;|&nbsp;(cs@(_:_),t)&nbsp;&lt;-&nbsp;[span&nbsp;p&nbsp;s]]<br />
   <br />
   </tt></p>

  <p></p>

  <hr />

  <p><i>The Haskell 98 Report</i><br />
   <a href="index.html">top</a> | <a href="complex.html">back</a> | <a
   href="ix.html">next</a> | <a href="index98.html">contents</a> | <a
   href="prelude-index.html">function index</a> <br />
   <font size="2">December 2002</font></p>

  <p></p>
 </body>
</html>
